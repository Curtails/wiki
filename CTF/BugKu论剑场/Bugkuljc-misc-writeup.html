<!DOCTYPE HTML>
<html>
<head>
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
    <link rel="shortcut icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/wiki/favicon.ico" type="image/x-icon">
    <title>BugKuCTF-论剑场-MISC-WriteUp - Curtails's personal knowledge wiki</title>
    <meta name="keywords" content="Technology, CTF, Network Security"/>
    <meta name="description" content="A wiki website of Curtails when I learned new knowledgy."/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width" />

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
        </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','','ga');

        ga('create', 'UA-78529611-1', 'auto');
        ga('send', 'pageview');

    </script>
</head>

<body>
<div id="container">
    
<div id="header">
  <div id="post-nav"><a href="/wiki/">Home</a>&nbsp;»&nbsp;<a href="/wiki/#CTF\BugKu论剑场">CTF\BugKu论剑场</a>&nbsp;»&nbsp;BugKuCTF-论剑场-MISC-WriteUp</div>
</div>
<div class="clearfix"></div>
<div id="title">BugKuCTF-论剑场-MISC-WriteUp</div>
<div id="content">
  <p>BugKuCTF-论剑场-MISC-WriteUp</p>
<h2 id="_1">头像</h2>
<p>得一张可爱妹子照片<br />
hint：flag为flag{flag的md5 32位加密值}<br />
- 丢进winhex 搜索flag得 <code>flag{bGxvdmV0aGVnaXJs}</code><br />
- 将{}内容base64解码 在MD5加密<br />
- 补全flag格式</p>
<h2 id="_2">签到</h2>
<p>白给</p>
<h2 id="01">0和1的故事</h2>
<p>hint；听说空格和零很配<br />
此题想法有些牵强<br />
- 下载得压缩包不断解压得txt 内容显示<code>Flag_is_not_here</code>加一堆空格<br />
- 丢进winhex发现有规律hex<br />
<code>0920200920092009092009200920090920200920200909092020200909092009200920090909092020202009090920090909090909202020202020</code><br />
  对照右侧ascii判断20是对应空格的 听说空格和0很配所以把20当作0 09当作1<br />
- 转换得<code>10010101101010110010011100011101010111100001110111111000000</code><br />
- 转换hex<code>4ad5938eaf0efc0</code><br />
- flag{4ad5938eaf0efc0}</p>
<h2 id="_3">这个人真的很高</h2>
<p>下载得一图片<br />
- 丢进winhex 末尾发现<code>aabI11us11ts1yy0}</code><br />
- 很高 那就改高加长一点改个800 打开图片得<code>ffoEliuaanrsgDey{</code><br />
- 拼起来<code>ffoEliuaanrsgDey{aabI11us11ts1yy0}</code>栅栏密码<br />
- 傻了 解不出来 查了其他人writeup最后靠猜？<code>flag{Iss0@finDa111}@ourea11y@@Easybuty@@</code> to <code>flag{Iss0Easybutyourea11yfinDa111}</code></p>
<h2 id="snake">snake</h2>
<p>hint：攒够500分就给flag哦<br />
竟然要500 王校长能吃那么多的面包吗<br />
- jd gui反编译出java代码 搜索flag 得到相关函数</p>
<div class="hlcode"><pre>    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">score</span> <span class="o">&gt;=</span> <span class="mi">500</span> <span class="o">&amp;&amp;</span> 
      <span class="k">this</span><span class="o">.</span><span class="na">isshow</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">String</span> <span class="n">flag</span> <span class="o">=</span> <span class="s">&quot;eobdxpmbhf\\jpgYaiibYagkc{&quot;</span><span class="o">;</span>
      <span class="kt">int</span> <span class="n">key</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">snake</span><span class="o">.</span><span class="na">len</span> <span class="o">-</span> <span class="k">this</span><span class="o">.</span><span class="na">score</span><span class="o">;</span>
      <span class="n">String</span> <span class="n">xx</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
      <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">flag</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>

        <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="kt">char</span> <span class="n">c1</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)(</span><span class="n">c</span> <span class="o">^</span> <span class="n">key</span><span class="o">);</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">xx</span><span class="o">)</span> <span class="o">+</span> <span class="n">c1</span><span class="o">;</span>
      <span class="o">}</span> 
      <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">flag</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>

        <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="kt">char</span> <span class="n">c1</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)(</span><span class="n">c</span> <span class="o">^</span> <span class="n">key</span> <span class="o">*</span> <span class="mi">2</span><span class="o">);</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">xx</span><span class="o">)</span> <span class="o">+</span> <span class="n">c1</span><span class="o">;</span>
      <span class="o">}</span> 

      <span class="n">JOptionPane</span><span class="o">.</span><span class="na">showInputDialog</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="s">&quot;This is your flag CALCULATE BY YOUR SCORE:\n&quot;</span><span class="o">,</span> <span class="s">&quot;Congratulations&quot;</span><span class="o">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> 
          <span class="n">xx</span><span class="o">);</span>

      <span class="k">this</span><span class="o">.</span><span class="na">isshow</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span> 
</pre></div>


<ul>
<li>可以看出这是一个求flag算法 没有直接给出flag</li>
<li>构造程序payload.java</li>
</ul>
<div class="hlcode"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">payload</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">String</span> <span class="n">flag</span> <span class="o">=</span> <span class="s">&quot;eobdxpmbhf\\jpgYaiibYagkc{&quot;</span><span class="o">;</span>
      <span class="kt">int</span> <span class="n">key</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
      <span class="n">String</span> <span class="n">xx</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
      <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">flag</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="kt">char</span> <span class="n">c1</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)(</span><span class="n">c</span> <span class="o">^</span> <span class="n">key</span><span class="o">);</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">xx</span><span class="o">)</span> <span class="o">+</span> <span class="n">c1</span><span class="o">;</span>
      <span class="o">}</span> 
      <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">flag</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="kt">char</span> <span class="n">c1</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)(</span><span class="n">c</span> <span class="o">^</span> <span class="n">key</span> <span class="o">*</span> <span class="mi">2</span><span class="o">);</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">xx</span><span class="o">)</span> <span class="o">+</span> <span class="n">c1</span><span class="o">;</span>
      <span class="o">}</span> 
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">xx</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<ul>
<li>运行得flag</li>
<li>或者直接上修改器 修改 长度 分数 </li>
<li>flag{snake_ia_good_game}</li>
</ul>
<h2 id="easypdf">easypdf</h2>
<p>下载解压得easy.pdf打显示好像不完整的图片<br />
- 丢进Adobe Acrobat DC 把图片挪一下 能看到背后的flag</p>
<h2 id="_4">损坏的图片</h2>
<p>下载得无法打开的图片<br />
- 丢进winhex观察结尾<code>47 4E 50 89</code>很明显是png<code>89 50 4E 47</code>倒序<br />
- 我们把整个文件hex倒序过来</p>
<div class="hlcode"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;string&gt;</span>
<span class="cp">#include &lt;algorithm&gt;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span> 
    <span class="kt">char</span> <span class="n">a</span><span class="p">[</span><span class="mi">15000</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;hex&quot;</span><span class="p">;</span><span class="c1">//hex太长</span>
    <span class="kt">char</span> <span class="n">b</span><span class="p">[</span><span class="mi">15000</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">strlen</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">){</span>

        <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">strlen</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="n">i</span><span class="p">];</span>
        <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">strlen</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">strlen</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>

        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<ul>
<li>得到反转之后的hex在winhex新建粘贴保存位1.png</li>
<li>打开图片为二维码 扫描即可</li>
<li>flag{f3f4a1a0d4e8e8e1f4a0f}</li>
</ul>
<h2 id="_5">怀疑人生</h2>
<p>下载解压得ctf1.zip ctf2.jpg ctf3.jpg<br />
- ctf1.zip有密码丢进winhex查看真加密 尝试暴力无果 尝试字典得密码<code>password</code><br />
  - 解压打开txt得字符串base64-去掉\u hex解码 得<code>flag{hacker</code> <br />
- ctf2.jpg丢进binwalk分离zip解压打开txt Ook!解码得<code>3oD54e</code><br />
  - 在进行base58解码字符串？？？<code>misc</code><br />
- ctf3.jpg扫描即可<code>12580}</code><br />
- 拼起来flag{hackermisc12580}</p>
<h2 id="_6">向日葵</h2>
<p>解压得一张图片<br />
- 丢进binwalk分离rar解压得txt打开</p>
<div class="hlcode"><pre><span class="err">在一个</span><span class="n">a</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="err">的二维数组中有下列几个元素</span>
<span class="err">（</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="err">）</span>
<span class="err">（</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="err">）</span>
<span class="err">（</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="err">）</span>
<span class="err">（</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="err">）</span>
<span class="err">（</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="err">）</span>
<span class="err">（</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="err">）</span>
<span class="err">（</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="err">）</span>
<span class="err">（</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="err">）</span>
<span class="err">（</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="err">）</span>
<span class="err">（</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="err">）</span>
<span class="err">（</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="err">）</span>
<span class="err">（</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="err">）</span>
<span class="err">（</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="err">）</span>
<span class="err">（</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="err">）</span>
<span class="err">（</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="err">）</span>
<span class="err">那么</span><span class="n">flag</span><span class="err">是什么呢？</span>
</pre></div>


<ul>
<li>类似于棋盘密码</li>
</ul>
<div class="hlcode"><pre>  <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span>
<span class="n">l</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span> <span class="n">e</span>
<span class="mi">2</span> <span class="n">f</span> <span class="n">g</span> <span class="n">h</span> <span class="n">i</span> <span class="n">j</span>
<span class="mi">3</span> <span class="n">k</span> <span class="mi">1</span> <span class="n">m</span> <span class="n">m</span> <span class="n">o</span>
<span class="mi">4</span> <span class="n">p</span> <span class="n">q</span> <span class="n">r</span> <span class="n">s</span> <span class="n">t</span>
<span class="mi">5</span> <span class="n">u</span> <span class="n">v</span> <span class="n">w</span> <span class="n">x</span> <span class="n">y</span>
</pre></div>


<ul>
<li>根据坐标得<code>juijoldugjtfbty</code></li>
<li>凯撒密码遍历得<code>ithinkctfiseasy</code> 题目牵强</li>
<li>flag{ithinkctfiseasy}</li>
</ul>
</div>
<div id="content-footer">created in <span class="create-date date"> 2019-08-31 01:01 </span></div>

</div>
<div id="footer">
            <span>
                Copyright © 2019 Curtails.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
                Fork me in <a href="" target="_blank"> github </a>.
            </span>
</div>


<!--百度统计-->
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</body>
</html>