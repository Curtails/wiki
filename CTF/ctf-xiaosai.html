<!DOCTYPE HTML>
<html>
<head>
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
    <link rel="shortcut icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/wiki/favicon.ico" type="image/x-icon">
    <title>2019-秋季-校-CTF-WriteUp - Curtails's personal knowledge wiki</title>
    <meta name="keywords" content="Technology, CTF, Network Security"/>
    <meta name="description" content="A wiki website of Curtails when I learned new knowledgy."/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width" />

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
        </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','','ga');

        ga('create', 'UA-78529611-1', 'auto');
        ga('send', 'pageview');

    </script>
</head>

<body>
<div id="container">
    
<div id="header">
  <div id="post-nav"><a href="/wiki/">Home</a>&nbsp;»&nbsp;<a href="/wiki/#CTF">CTF</a>&nbsp;»&nbsp;2019-秋季-校-CTF-WriteUp</div>
</div>
<div class="clearfix"></div>
<div id="title">2019-秋季-校-CTF-WriteUp</div>
<div id="content">
  <p>2019-秋季-校-CTF-WriteUp.<br />
记录一次真正意义上的CTF比赛；吸取教训，总结经验。<br />
- 教训：远远不够仔细 不够熟练<br />
- 经验：第一次知识在实战中磨合 有了印象</p>
<h1 id="_1">加密</h1>
<h2 id="easycrypto"><mark>Easycrypto</mark></h2>
<p>下载解压得lookcarefully.txt 打开显示</p>
<div class="hlcode"><pre><span class="n">WXAD</span> <span class="mi">3</span><span class="n">dwr</span> <span class="n">G_VN</span> <span class="n">qz_s</span> <span class="n">RVDG</span> <span class="mi">8</span><span class="n">kuo</span> <span class="o">-</span><span class="err">&#39;</span><span class="n">p</span><span class="p">]</span> <span class="o">!</span><span class="n">A_W</span> <span class="n">wxad</span> <span class="n">h_bm</span> <span class="n">rvdg</span> <span class="n">h_bm</span> <span class="n">ECSF</span> <span class="n">WXAD</span> <span class="n">wxad</span> <span class="o">=</span><span class="n">_</span><span class="p">[</span>\
</pre></div>


<p>这题没做出来的人是真的蠢 比如我 <br />
- 键盘密码 四个键位两两包围一个键位 拼起来即可<br />
- SeBaFi{QsnfnDSs}</p>
<h2 id="warm-up"><mark>Warm up</mark></h2>
<p>打开所给网址 显示以下信息</p>
<div class="hlcode"><pre><span class="x">$flag=&quot;SeBaFi(*}&quot;; echo base64encode(gzcompress(hex2bin(strrev(urlencode(bin2hex($flag))))</span>
<span class="x">eJy7btoSfK20uWRbsJvxEfPIbUuWLCteli7qnnJsi2lYacuxtO3TUsRUwkwBjV4STA==</span>
</pre></div>


<p>比赛时 字符串给的是错的？！现在的也是？？<br />
- 按照代码的编码逆序解码即可</p>
<div class="hlcode"><pre><span class="cp">&lt;?php</span>
<span class="nv">$s</span><span class="o">=</span><span class="nx">eJy7btoSfK20uWRbsJvxEfPIbUuWLCteli7qnnJsi2lYacuxtO3TUsRUwkwBjV4STA</span><span class="o">==</span><span class="p">;</span>
<span class="k">echo</span> <span class="nx">hex2bin</span><span class="p">(</span><span class="nb">urldecode</span><span class="p">(</span><span class="nb">strrev</span><span class="p">(</span><span class="nb">bin2hex</span><span class="p">(</span><span class="nb">gzuncompress</span><span class="p">(</span><span class="nx">base64</span> <span class="nx">decode</span><span class="p">(</span><span class="nv">$s</span><span class="p">))))));</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>


<ul>
<li>SeBaFi{flHWeSKlFtQqJ7jJJhzsL3d5kG8Wm5HS}</li>
</ul>
<h2 id="read-me"><mark>read me</mark></h2>
<p>下载的压缩包含四个文件<code>1.txt 2.txt 3.txt flag.txt</code><br />
Hint:小小小<br />
- 1 2 3文件小所以采用CRC碰撞绕过zip密码</p>
<div class="hlcode"><pre><span class="c">#coding:utf-8</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">binascii</span>

<span class="k">def</span> <span class="nf">CrackCrc</span><span class="p">(</span><span class="n">crc</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dic</span> <span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span>
                <span class="c">#for q in dic:</span>
                    <span class="n">s</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">p</span><span class="o">+</span><span class="n">q</span>
                    <span class="k">if</span> <span class="n">crc</span> <span class="o">==</span> <span class="p">(</span><span class="n">binascii</span><span class="o">.</span><span class="n">crc32</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">):</span>
                        <span class="c">#print s  </span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
                        <span class="k">return</span>  

<span class="k">def</span> <span class="nf">CrackZip</span><span class="p">():</span> 
    <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">54</span><span class="p">):</span>
        <span class="nb">file</span> <span class="o">=</span> <span class="s">&#39;chunk&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;.zip&#39;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">GetCrc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">getinfo</span><span class="p">(</span><span class="s">&#39;data.txt&#39;</span><span class="p">)</span>
        <span class="n">crc</span> <span class="o">=</span> <span class="n">GetCrc</span><span class="o">.</span><span class="n">CRC</span>
        <span class="c">#以上3行为获取压缩包CRC32值的步骤</span>
        <span class="n">CrackCrc</span><span class="p">(</span><span class="n">crc</span><span class="p">)</span>

<span class="n">dic</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span> <span class="s">&#39;+/=&#39;</span>
<span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s">&#39;out.txt&#39;</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
<span class="n">CrackZip</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>


<ul>
<li>分别执行三个txt文件的crc值 找出有规律的字符串</li>
<li><code>keyisc rc32ue nit!@#</code>拼一起<code>keyiscrc32uenit!@#</code>为解压密码</li>
<li>解压得flag</li>
<li>SeBaFi{anheipo_huai_shen_three}</li>
</ul>
<h2 id="_2"><mark>又是维吉尼亚</mark></h2>
<p>打开txt</p>
<div class="hlcode"><pre><span class="n">cmzzwtcdlimzydhphdelohroipptlwetydtchvadozstwdcmznyzvdqomiwzwivacmznyzv</span>
<span class="n">rhzwtcltmawvtvzvjphwopivjyijzdzgdwimzwyqqtmdzahdipwtrtyvdwvyskzmtcltmawroimirdzmwwzvdz</span>
<span class="n">vrzwivaweppikpzwipwtriprypidzwpzghripazvwhdeivadozfzehwuhmjhvhi</span> 

<span class="n">NmSgNv</span><span class="p">{</span><span class="n">m09f718v9kr8gk7p66ncv38nr0i44640</span><span class="p">}</span>
</pre></div>


<ul>
<li>注意题目无密钥 密码描述为一长串的字符串 猜测词频分析</li>
<li>访问https://quipqiup.com/ 模式选择<code>statistics</code>进行词频分析</li>
<li>提取密钥<code>virginia</code></li>
<li>利用密钥解密<code>NmSgNv{m09f718v9kr8gk7p66ncv38nr0i44640}</code></li>
<li>SeBaFi{e09f718a9ca8ac7c66fca38fa0c44640}</li>
</ul>
<h2 id="rsa"><mark>rsa</mark></h2>
<p>hint：常规rsa<br />
rsa不懂 留坑</p>
<h1 id="misc">MISC</h1>
<h2 id="hiddenbears"><mark>hiddenbears</mark></h2>
<p>下载解压得到一张显示四头熊的图片<br />
- 看属性 无<br />
- 丢进winhex 无果<br />
- 丢进binwalk 无果<br />
- 丢进StegSolve 四周有白边<br />
- 切换几次颜色通道 能看到最上边有字符串 加上格式即可<br />
- SeBaFi{Ao39gPDEzwrkojhEqNmtuDKc} </p>
<h2 id="wakaka">wakaka</h2>
<p>下载得压缩包 有密码 压缩里面是flag.txt<br />
hint：密码为wakaka+五位数字<br />
- 上工具直接爆破 得密码<code>wakaka21051</code></p>
<h2 id="hidden91">Hidden91</h2>
<p>下载得图片<br />
- binwalk得压缩包解压得txt<br />
- 打开txt<code>7E4F66637478532424313A28352A24533E31514A255F245938216A7B420A</code><br />
- base16解码得<code>~OfctxS$$1:(5*$S&gt;1QJ%_$Y8!j{B</code><br />
- 结合题目91 猜测base91解码<br />
- SeBaFi{170065%shtxdddk}</p>
<h2 id="_3">二维码动图</h2>
<p>下载得一gif<br />
- 没啥好说的逐帧分离gif 一个个就成<br />
- SeBaFi{mAr10_i5_a_br0} </p>
<h2 id="_4"><mark>泰加熊</mark></h2>
<p>很恶心的题<br />
下载解压得七张图片<br />
- binwalk一个个试 第六张图片有点东西 分离出zip<br />
- 解压得名字为msg文件<br />
- 在linux下执行<code>./msg</code>可打开此文件<br />
- Flag: B3znJluppFPJnNG7PAg</p>
<h2 id="mmmmmm"><mark>mmmmmm</mark></h2>
<p>下载得一图片<br />
- binwalk 分离出zip <br />
- 解压得readme.txt和另一个zip 此zip中含readme.txt及flag.txt<br />
- 这是明文攻击<br />
- 使用 AZPR 工具，选择文本攻击/AAPR明文竟然没用<br />
- SeBaFif{readme_64%_jok}</p>
<h1 id="pwn">PWN</h1>
<h2 id="_5"><mark>简单的溢出?</mark></h2>
<p>确实简单 只有蠢人不会做 比如我<br />
- PEiD 分析发现不是有效的PE文件 可能试dos16位<br />
- 丢进ida32 查找字符串即可<br />
- SebaFi{4cc09188c005dc1a5fad8c6e2551903}</p>
<h2 id="shell"><mark>拼接成 shell</mark></h2>
<p>留坑</p>
<h1 id="reverse">Reverse</h1>
<h2 id="_6"><mark>安卓签到 </mark></h2>
<ul>
<li>使用 jadx 工具反编译 apk</li>
<li>查看res/layput/activity_main.xml</li>
<li>SeBaFi{ee2faeed038501c1deab01c7b54f2fa9}</li>
</ul>
<h2 id="4"><mark>4 位数</mark></h2>
<p>下载得re3.ppp<br />
- 丢进ida32 选中main反编译 得</p>
<div class="hlcode"><pre><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [esp+24h] [ebp-84h]</span>
  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [esp+30h] [ebp-78h]</span>
  <span class="kt">char</span> <span class="n">nptr</span><span class="p">;</span> <span class="c1">// [esp+38h] [ebp-70h]</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [esp+9Ch] [ebp-Ch]</span>

  <span class="n">v7</span> <span class="o">=</span> <span class="n">__readgsdword</span><span class="p">(</span><span class="mh">0x14u</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;please input the key:&quot;</span><span class="p">);</span>
  <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nptr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x64u</span><span class="p">);</span>
  <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nptr</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">strlen</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nptr</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span>
    <span class="o">||</span> <span class="p">(</span><span class="n">v4</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nptr</span><span class="p">),</span> <span class="n">v5</span> <span class="o">=</span> <span class="n">v4</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">/</span> <span class="mi">10</span><span class="p">,</span> <span class="n">v4</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">v5</span> <span class="o">+</span> <span class="n">v4</span> <span class="o">/</span> <span class="mi">1000</span> <span class="o">+</span> <span class="n">v4</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">!=</span> <span class="mi">23</span><span class="p">)</span>
    <span class="o">||</span> <span class="n">v5</span> <span class="o">/</span> <span class="p">(</span><span class="n">v4</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span>
    <span class="o">||</span> <span class="n">v4</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">v5</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="o">||</span> <span class="n">v4</span> <span class="o">/</span> <span class="mi">1000</span> <span class="o">%</span> <span class="n">v5</span> <span class="o">!=</span> <span class="mi">3</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">&quot;wrong!&quot;</span><span class="p">);</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">&quot;correct!&quot;</span><span class="p">);</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<ul>
<li>根据功能 写payload</li>
<li>SeBaFi{9563} SeBaFi{9563} </li>
</ul>
<h2 id="vvv"><mark>vvv </mark></h2>
<p>留坑</p>
<h1 id="web">Web</h1>
<h2 id="_7">签到</h2>
<p>白给题 查看源代码</p>
<h2 id="easy">easy</h2>
<p>打开网页显示 “Only allowed access by local address<br />
- 明显xff<br />
- 抓包加上<code>X-Forwarded-For: 127.0.0.1</code> go 显示信息提示我们access admin<br />
- 找到cookie<code>user=Z3Vlc3Q%3D</code> 试guest的base64 把admin的base64替换它 go<br />
- SeBaFi{a5717a649d346ed0c51be68888c130cd}</p>
<h2 id="md5">相同的 MD5</h2>
<p>打开网页找到最终网页<br />
- 啥也不说了 直接数组走起</p>
<h2 id="_8"><mark>序列化 </mark></h2>
<p>留坑</p>
<h2 id="_9"><mark>过四关</mark></h2>
<p>留坑</p>
</div>
<div id="content-footer">Created in <span class="create-date date"> 2019-08-28 01:01 </span></div>

</div>
<div id="footer">
            <span>
                Copyright © 2019 Curtails.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
                Fork me in <a href="" target="_blank"> github </a>.
            </span>
</div>


<!--百度统计-->
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</body>
</html>